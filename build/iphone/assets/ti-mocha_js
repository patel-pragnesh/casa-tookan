
;(function(){

function require(p){
var path=require.resolve(p),
mod=require.modules[path];
if(!mod)throw new Error('failed to require "'+p+'"');




return mod.exports||(mod.exports={},mod.call(mod.exports,mod,mod.exports,require.relative(path))),mod.exports;
}


























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































function timeslice(){for(
var immediateStart=new Date().getTime();
immediateQueue.length&&100>new Date().getTime()-immediateStart;)
immediateQueue.shift()();


immediateTimeout=immediateQueue.length?setTimeout(timeslice,0):

null;

}


































































































































































































































































































































































































































































































































































































































function createConsoleLogger(type){
console[type]=function(){
var util=require('titanium/util'),
args=Array.prototype.slice.call(arguments,0),
rawArgs=args.slice(0),
isStudio=/\-studio$/.test(mocha._ti_reporter);

if(!mocha._ti_quiet){
if(0===args.length)
isStudio?
args.push(util.cursor.reset+' '+util.cursor.reset):

args.push(util.cursor.resetLine);else

{
var prefix=util.cursor.resetLine;
isStudio||(
args[0]=prefix+(args[0]||'').toString().split(/(?:\r\n|\n|\r)/).join('\n'+prefix));

}

Ti.API.log('log'===type?'info':type,util.format.apply(this,args));
}

mocha._ti_output_file&&
mocha._ti_output_file.append(util.format.apply(this,rawArgs).replace(/\x1B\[[0-9;]*[a-zA-Z]/g,''));

};
}var _Mathfloor=Math.floor,_MathPI=Math.PI,_Mathmin=Math.min;require.modules={},require.resolve=function(path){var orig=path,reg=path+'.js',index=path+'/index.js';return require.modules[reg]&&reg||require.modules[index]&&index||orig},require.register=function(path,fn){require.modules[path]=fn},require.relative=function(parent){return function(p){if('.'!=p.charAt(0))return require(p);var path=parent.split('/'),segs=p.split('/');path.pop();for(var seg,i=0;i<segs.length;i++)seg=segs[i],'..'==seg?path.pop():'.'!=seg&&path.push(seg);return require(path.join('/'))}},require.register('browser/debug.js',function(module,exports,require){module.exports=function(type){return function(){}}}),require.register('browser/diff.js',function(module,exports,require){var JsDiff=function(){function clonePath(path){return{newPos:path.newPos,components:path.components.slice(0)}}function removeEmpty(array){for(var ret=[],i=0;i<array.length;i++)array[i]&&ret.push(array[i]);return ret}function escapeHTML(s){var n=s;return n=n.replace(/&/g,'&amp;'),n=n.replace(/</g,'&lt;'),n=n.replace(/>/g,'&gt;'),n=n.replace(/"/g,'&quot;'),n}var Diff=function(ignoreWhitespace){this.ignoreWhitespace=ignoreWhitespace};Diff.prototype={diff:function(oldString,newString){if(newString===oldString)return[{value:newString}];if(!newString)return[{value:oldString,removed:!0}];if(!oldString)return[{value:newString,added:!0}];newString=this.tokenize(newString),oldString=this.tokenize(oldString);var newLen=newString.length,oldLen=oldString.length,maxEditLength=newLen+oldLen,bestPath=[{newPos:-1,components:[]}],oldPos=this.extractCommon(bestPath[0],newString,oldString,0);if(bestPath[0].newPos+1>=newLen&&oldPos+1>=oldLen)return bestPath[0].components;for(var editLength=1;editLength<=maxEditLength;editLength++)for(var diagonalPath=-1*editLength;diagonalPath<=editLength;diagonalPath+=2){var basePath,addPath=bestPath[diagonalPath-1],removePath=bestPath[diagonalPath+1];oldPos=(removePath?removePath.newPos:0)-diagonalPath,addPath&&(bestPath[diagonalPath-1]=void 0);var canAdd=addPath&&addPath.newPos+1<newLen,canRemove=removePath&&0<=oldPos&&oldPos<oldLen;if(!canAdd&&!canRemove){bestPath[diagonalPath]=void 0;continue}!canAdd||canRemove&&addPath.newPos<removePath.newPos?(basePath=clonePath(removePath),this.pushComponent(basePath.components,oldString[oldPos],void 0,!0)):(basePath=clonePath(addPath),basePath.newPos++,this.pushComponent(basePath.components,newString[basePath.newPos],!0,void 0));var oldPos=this.extractCommon(basePath,newString,oldString,diagonalPath);if(basePath.newPos+1>=newLen&&oldPos+1>=oldLen)return basePath.components;bestPath[diagonalPath]=basePath}},pushComponent:function(components,value,added,removed){var last=components[components.length-1];last&&last.added===added&&last.removed===removed?components[components.length-1]={value:this.join(last.value,value),added:added,removed:removed}:components.push({value:value,added:added,removed:removed})},extractCommon:function(basePath,newString,oldString,diagonalPath){for(var newLen=newString.length,oldLen=oldString.length,newPos=basePath.newPos,oldPos=newPos-diagonalPath;newPos+1<newLen&&oldPos+1<oldLen&&this.equals(newString[newPos+1],oldString[oldPos+1]);)newPos++,oldPos++,this.pushComponent(basePath.components,newString[newPos],void 0,void 0);return basePath.newPos=newPos,oldPos},equals:function(left,right){var reWhitespace=/\S/;return!this.ignoreWhitespace||reWhitespace.test(left)||reWhitespace.test(right)?left===right:!0},join:function(left,right){return left+right},tokenize:function(value){return value}};var CharDiff=new Diff,WordDiff=new Diff(!0),WordWithSpaceDiff=new Diff;WordDiff.tokenize=WordWithSpaceDiff.tokenize=function(value){return removeEmpty(value.split(/(\s+|\b)/))};var CssDiff=new Diff(!0);CssDiff.tokenize=function(value){return removeEmpty(value.split(/([{}:;,]|\s+)/))};var LineDiff=new Diff;return LineDiff.tokenize=function(value){for(var retLines=[],lines=value.split(/^/m),i=0;i<lines.length;i++){var line=lines[i],lastLine=lines[i-1];'\n'==line&&lastLine&&'\r'===lastLine[lastLine.length-1]?retLines[retLines.length-1]+='\n':line&&retLines.push(line)}return retLines},{Diff:Diff,diffChars:function(oldStr,newStr){return CharDiff.diff(oldStr,newStr)},diffWords:function(oldStr,newStr){return WordDiff.diff(oldStr,newStr)},diffWordsWithSpace:function(oldStr,newStr){return WordWithSpaceDiff.diff(oldStr,newStr)},diffLines:function(oldStr,newStr){return LineDiff.diff(oldStr,newStr)},diffCss:function(oldStr,newStr){return CssDiff.diff(oldStr,newStr)},createPatch:function(fileName,oldStr,newStr,oldHeader,newHeader){function contextLines(lines){return lines.map(function(entry){return' '+entry})}function eofNL(curRange,i,current){var last=diff[diff.length-2],isLast=i===diff.length-2,isLastOfType=i===diff.length-3&&(current.added!==last.added||current.removed!==last.removed);!/\n$/.test(current.value)&&(isLast||isLastOfType)&&curRange.push('\\ No newline at end of file')}var ret=['Index: '+fileName,'===================================================================','--- '+fileName+('undefined'==typeof oldHeader?'':'\t'+oldHeader),'+++ '+fileName+('undefined'==typeof newHeader?'':'\t'+newHeader)],diff=LineDiff.diff(oldStr,newStr);diff[diff.length-1].value||diff.pop(),diff.push({value:'',lines:[]});for(var oldRangeStart=0,newRangeStart=0,curRange=[],oldLine=1,newLine=1,i=0;i<diff.length;i++){var current=diff[i],lines=current.lines||current.value.replace(/\n$/,'').split('\n');if(current.lines=lines,current.added||current.removed){if(!oldRangeStart){var prev=diff[i-1];oldRangeStart=oldLine,newRangeStart=newLine,prev&&(curRange=contextLines(prev.lines.slice(-4)),oldRangeStart-=curRange.length,newRangeStart-=curRange.length)}curRange.push.apply(curRange,lines.map(function(entry){return(current.added?'+':'-')+entry})),eofNL(curRange,i,current),current.added?newLine+=lines.length:oldLine+=lines.length}else{if(oldRangeStart)if(8>=lines.length&&i<diff.length-2)curRange.push.apply(curRange,contextLines(lines));else{var contextSize=_Mathmin(lines.length,4);ret.push('@@ -'+oldRangeStart+','+(oldLine-oldRangeStart+contextSize)+' +'+newRangeStart+','+(newLine-newRangeStart+contextSize)+' @@'),ret.push.apply(ret,curRange),ret.push.apply(ret,contextLines(lines.slice(0,contextSize))),4>=lines.length&&eofNL(ret,i,current),oldRangeStart=0,newRangeStart=0,curRange=[]}oldLine+=lines.length,newLine+=lines.length}}return ret.join('\n')+'\n'},applyPatch:function(oldStr,uniDiff){for(var diffstr=uniDiff.split('\n'),diff=[],remEOFNL=!1,addEOFNL=!1,i='I'===diffstr[0][0]?4:0;i<diffstr.length;i++)if('@'===diffstr[i][0]){var meh=diffstr[i].split(/@@ -(\d+),(\d+) \+(\d+),(\d+) @@/);diff.unshift({start:meh[3],oldlength:meh[2],oldlines:[],newlength:meh[4],newlines:[]})}else'+'===diffstr[i][0]?diff[0].newlines.push(diffstr[i].substr(1)):'-'===diffstr[i][0]?diff[0].oldlines.push(diffstr[i].substr(1)):' '===diffstr[i][0]?(diff[0].newlines.push(diffstr[i].substr(1)),diff[0].oldlines.push(diffstr[i].substr(1))):'\\'===diffstr[i][0]&&('+'===diffstr[i-1][0]?remEOFNL=!0:'-'===diffstr[i-1][0]&&(addEOFNL=!0));for(var d,str=oldStr.split('\n'),i=diff.length-1;0<=i;i--){d=diff[i];for(var j=0;j<d.oldlength;j++)if(str[d.start-1+j]!==d.oldlines[j])return!1;Array.prototype.splice.apply(str,[d.start-1,+d.oldlength].concat(d.newlines))}if(remEOFNL)for(;!str[str.length-1];)str.pop();else addEOFNL&&str.push('');return str.join('\n')},convertChangesToXML:function(changes){for(var change,ret=[],i=0;i<changes.length;i++)change=changes[i],change.added?ret.push('<ins>'):change.removed&&ret.push('<del>'),ret.push(escapeHTML(change.value)),change.added?ret.push('</ins>'):change.removed&&ret.push('</del>');return ret.join('')},convertChangesToDMP:function(changes){for(var change,ret=[],i=0;i<changes.length;i++)change=changes[i],ret.push([change.added?1:change.removed?-1:0,change.value]);return ret}}}();'undefined'!=typeof module&&(module.exports=JsDiff)}),require.register('browser/escape-string-regexp.js',function(module,exports,require){'use strict';var matchOperatorsRe=/[|\\{}()[\]^$+*?.]/g;module.exports=function(str){if('string'!=typeof str)throw new TypeError('Expected a string');return str.replace(matchOperatorsRe,'\\$&')}}),require.register('browser/events.js',function(module,exports,require){function isArray(obj){return'[object Array]'=={}.toString.call(obj)}function EventEmitter(){}exports.EventEmitter=EventEmitter;;EventEmitter.prototype.on=function(name,fn){return this.$events||(this.$events={}),this.$events[name]?isArray(this.$events[name])?this.$events[name].push(fn):this.$events[name]=[this.$events[name],fn]:this.$events[name]=fn,this},EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.once=function(name,fn){function on(){self.removeListener(name,on),fn.apply(this,arguments)}var self=this;;return on.listener=fn,this.on(name,on),this},EventEmitter.prototype.removeListener=function(name,fn){if(this.$events&&this.$events[name]){var list=this.$events[name];if(isArray(list)){for(var pos=-1,i=0,l=list.length;i<l;i++)if(list[i]===fn||list[i].listener&&list[i].listener===fn){pos=i;break}if(0>pos)return this;list.splice(pos,1),list.length||delete this.$events[name]}else(list===fn||list.listener&&list.listener===fn)&&delete this.$events[name]}return this},EventEmitter.prototype.removeAllListeners=function(name){return void 0===name?(this.$events={},this):(this.$events&&this.$events[name]&&(this.$events[name]=null),this)},EventEmitter.prototype.listeners=function(name){return this.$events||(this.$events={}),this.$events[name]||(this.$events[name]=[]),isArray(this.$events[name])||(this.$events[name]=[this.$events[name]]),this.$events[name]},EventEmitter.prototype.emit=function(name){if(!this.$events)return!1;var handler=this.$events[name];if(!handler)return!1;var args=[].slice.call(arguments,1);if('function'==typeof handler)handler.apply(this,args);else if(isArray(handler))for(var listeners=handler.slice(),i=0,l=listeners.length;i<l;i++)listeners[i].apply(this,args);else return!1;return!0}}),require.register('browser/fs.js',function(module,exports,require){}),require.register('browser/glob.js',function(module,exports,require){}),require.register('browser/path.js',function(module,exports,require){}),require.register('browser/progress.js',function(module,exports,require){function Progress(){this.percent=0,this.size(0),this.fontSize(11),this.font('helvetica, arial, sans-serif')}module.exports=Progress,Progress.prototype.size=function(n){return this._size=n,this},Progress.prototype.text=function(str){return this._text=str,this},Progress.prototype.fontSize=function(n){return this._fontSize=n,this},Progress.prototype.font=function(family){return this._font=family,this},Progress.prototype.update=function(n){return this.percent=n,this},Progress.prototype.draw=function(ctx){try{var percent=_Mathmin(this.percent,100),size=this._size,half=size/2,x=half,y=half,rad=half-1,fontSize=this._fontSize;ctx.font=fontSize+'px '+this._font;var angle=2*_MathPI*(percent/100);ctx.clearRect(0,0,size,size),ctx.strokeStyle='#9f9f9f',ctx.beginPath(),ctx.arc(x,y,rad,0,angle,!1),ctx.stroke(),ctx.strokeStyle='#eee',ctx.beginPath(),ctx.arc(x,y,rad-1,0,angle,!0),ctx.stroke();var text=this._text||(0|percent)+'%',w=ctx.measureText(text).width;ctx.fillText(text,x-w/2+1,y+fontSize/2-1)}catch(ex){}return this}}),require.register('browser/tty.js',function(module,exports,require){exports.isatty=function(){return!0},exports.getWindowSize=function(){return'innerHeight'in global?[global.innerHeight,global.innerWidth]:[640,480]}}),require.register('context.js',function(module,exports,require){function Context(){}module.exports=Context,Context.prototype.runnable=function(runnable){return 0==arguments.length?this._runnable:(this.test=this._runnable=runnable,this)},Context.prototype.timeout=function(ms){return 0===arguments.length?this.runnable().timeout():(this.runnable().timeout(ms),this)},Context.prototype.enableTimeouts=function(enabled){return this.runnable().enableTimeouts(enabled),this},Context.prototype.slow=function(ms){return this.runnable().slow(ms),this},Context.prototype.inspect=function(){return JSON.stringify(this,function(key,val){return'_runnable'==key||'test'==key?void 0:val},2)}}),require.register('hook.js',function(module,exports,require){function Hook(title,fn){Runnable.call(this,title,fn),this.type='hook'}function F(){}var Runnable=require('./runnable');module.exports=Hook;;F.prototype=Runnable.prototype,Hook.prototype=new F,Hook.prototype.constructor=Hook,Hook.prototype.error=function(err){if(0==arguments.length){var err=this._error;return this._error=null,err}this._error=err}}),require.register('interfaces/bdd.js',function(module,exports,require){var Suite=require('../suite'),Test=require('../test'),utils=require('../utils'),escapeRe=require('browser/escape-string-regexp');module.exports=function(suite){var suites=[suite];suite.on('pre-require',function(context,file,mocha){context.before=function(name,fn){suites[0].beforeAll(name,fn)},context.after=function(name,fn){suites[0].afterAll(name,fn)},context.beforeEach=function(name,fn){suites[0].beforeEach(name,fn)},context.afterEach=function(name,fn){suites[0].afterEach(name,fn)},context.describe=context.context=function(title,fn){var suite=Suite.create(suites[0],title);return suite.file=file,suites.unshift(suite),fn.call(suite),suites.shift(),suite},context.xdescribe=context.xcontext=context.describe.skip=function(title,fn){var suite=Suite.create(suites[0],title);suite.pending=!0,suites.unshift(suite),fn.call(suite),suites.shift()},context.describe.only=function(title,fn){var suite=context.describe(title,fn);return mocha.grep(suite.fullTitle()),suite},context.it=context.specify=function(title,fn){var suite=suites[0];suite.pending&&(fn=null);var test=new Test(title,fn);return test.file=file,suite.addTest(test),test},context.it.only=function(title,fn){var test=context.it(title,fn),reString='^'+escapeRe(test.fullTitle())+'$';return mocha.grep(new RegExp(reString)),test},context.xit=context.xspecify=context.it.skip=function(title){context.it(title)}})}}),require.register('interfaces/exports.js',function(module,exports,require){var Suite=require('../suite'),Test=require('../test');module.exports=function(suite){function visit(obj,file){var suite;for(var key in obj)if('function'==typeof obj[key]){var fn=obj[key];switch(key){case'before':suites[0].beforeAll(fn);break;case'after':suites[0].afterAll(fn);break;case'beforeEach':suites[0].beforeEach(fn);break;case'afterEach':suites[0].afterEach(fn);break;default:var test=new Test(key,fn);test.file=file,suites[0].addTest(test);}}else suite=Suite.create(suites[0],key),suites.unshift(suite),visit(obj[key]),suites.shift()}var suites=[suite];suite.on('require',visit)}}),require.register('interfaces/index.js',function(module,exports,require){exports.bdd=require('./bdd'),exports.tdd=require('./tdd'),exports.qunit=require('./qunit'),exports.exports=require('./exports')}),require.register('interfaces/qunit.js',function(module,exports,require){var Suite=require('../suite'),Test=require('../test'),escapeRe=require('browser/escape-string-regexp'),utils=require('../utils');module.exports=function(suite){var suites=[suite];suite.on('pre-require',function(context,file,mocha){context.before=function(name,fn){suites[0].beforeAll(name,fn)},context.after=function(name,fn){suites[0].afterAll(name,fn)},context.beforeEach=function(name,fn){suites[0].beforeEach(name,fn)},context.afterEach=function(name,fn){suites[0].afterEach(name,fn)},context.suite=function(title){1<suites.length&&suites.shift();var suite=Suite.create(suites[0],title);return suite.file=file,suites.unshift(suite),suite},context.suite.only=function(title,fn){var suite=context.suite(title,fn);mocha.grep(suite.fullTitle())},context.test=function(title,fn){var test=new Test(title,fn);return test.file=file,suites[0].addTest(test),test},context.test.only=function(title,fn){var test=context.test(title,fn),reString='^'+escapeRe(test.fullTitle())+'$';mocha.grep(new RegExp(reString))},context.test.skip=function(title){context.test(title)}})}}),require.register('interfaces/tdd.js',function(module,exports,require){var Suite=require('../suite'),Test=require('../test'),escapeRe=require('browser/escape-string-regexp'),utils=require('../utils');module.exports=function(suite){var suites=[suite];suite.on('pre-require',function(context,file,mocha){context.setup=function(name,fn){suites[0].beforeEach(name,fn)},context.teardown=function(name,fn){suites[0].afterEach(name,fn)},context.suiteSetup=function(name,fn){suites[0].beforeAll(name,fn)},context.suiteTeardown=function(name,fn){suites[0].afterAll(name,fn)},context.suite=function(title,fn){var suite=Suite.create(suites[0],title);return suite.file=file,suites.unshift(suite),fn.call(suite),suites.shift(),suite},context.suite.skip=function(title,fn){var suite=Suite.create(suites[0],title);suite.pending=!0,suites.unshift(suite),fn.call(suite),suites.shift()},context.suite.only=function(title,fn){var suite=context.suite(title,fn);mocha.grep(suite.fullTitle())},context.test=function(title,fn){var suite=suites[0];suite.pending&&(fn=null);var test=new Test(title,fn);return test.file=file,suite.addTest(test),test},context.test.only=function(title,fn){var test=context.test(title,fn),reString='^'+escapeRe(test.fullTitle())+'$';mocha.grep(new RegExp(reString))},context.test.skip=function(title){context.test(title)}})}}),require.register('mocha.js',function(module,exports,require){function image(name){return __dirname+'/../images/'+name+'.png'}function Mocha(options){options=options||{},this.files=[],this.options=options,this.grep(options.grep),this.suite=new exports.Suite('',new exports.Context()),this.ui(options.ui),this.bail(options.bail),this.reporter(options.reporter),null!=options.timeout&&this.timeout(options.timeout),this.useColors(options.useColors),null!==options.enableTimeouts&&this.enableTimeouts(options.enableTimeouts),options.slow&&this.slow(options.slow),this.suite.on('pre-require',function(context){exports.afterEach=context.afterEach||context.teardown,exports.after=context.after||context.suiteTeardown,exports.beforeEach=context.beforeEach||context.setup,exports.before=context.before||context.suiteSetup,exports.describe=context.describe||context.suite,exports.it=context.it||context.test,exports.setup=context.setup||context.beforeEach,exports.suiteSetup=context.suiteSetup||context.before,exports.suiteTeardown=context.suiteTeardown||context.after,exports.suite=context.suite||context.describe,exports.teardown=context.teardown||context.afterEach,exports.test=context.test||context.it})}var path=require('browser/path'),escapeRe=require('browser/escape-string-regexp'),utils=require('./utils');if(exports=module.exports=Mocha,'undefined'!=typeof process&&'function'==typeof process.cwd){var join=path.join,cwd=process.cwd();module.paths.push(cwd,join(cwd,'node_modules'))}exports.utils=utils,exports.interfaces=require('./interfaces'),exports.reporters=require('./reporters'),exports.Runnable=require('./runnable'),exports.Context=require('./context'),exports.Runner=require('./runner'),exports.Suite=require('./suite'),exports.Hook=require('./hook'),exports.Test=require('./test'),Mocha.prototype.bail=function(bail){return 0==arguments.length&&(bail=!0),this.suite.bail(bail),this},Mocha.prototype.addFile=function(file){return this.files.push(file),this},Mocha.prototype.reporter=function(reporter){if('function'==typeof reporter)this._reporter=reporter;else{reporter=reporter||'spec';var _reporter;try{_reporter=require('./reporters/'+reporter)}catch(err){};if(!_reporter)try{_reporter=require(reporter)}catch(err){};if(_reporter||'teamcity'!==reporter||console.warn('The Teamcity reporter was moved to a package named mocha-teamcity-reporter (https://npmjs.org/package/mocha-teamcity-reporter).'),!_reporter)throw new Error('invalid reporter "'+reporter+'"');this._reporter=_reporter}return this},Mocha.prototype.ui=function(name){if(name=name||'bdd',this._ui=exports.interfaces[name],!this._ui)try{this._ui=require(name)}catch(err){};if(!this._ui)throw new Error('invalid interface "'+name+'"');return this._ui=this._ui(this.suite),this},Mocha.prototype.loadFiles=function(fn){var self=this,suite=this.suite,pending=this.files.length;this.files.forEach(function(file){file=path.resolve(file),suite.emit('pre-require',global,file,self),suite.emit('require',require(file),file,self),suite.emit('post-require',global,file,self),--pending||fn&&fn()})},Mocha.prototype._growl=function(runner,reporter){var notify=require('growl');runner.on('end',function(){var stats=reporter.stats;if(stats.failures){var msg=stats.failures+' of '+runner.total+' tests failed';notify(msg,{name:'mocha',title:'Failed',image:image('error')})}else notify(stats.passes+' tests passed in '+stats.duration+'ms',{name:'mocha',title:'Passed',image:image('ok')})})},Mocha.prototype.grep=function(re){return this.options.grep='string'==typeof re?new RegExp(escapeRe(re)):re,this},Mocha.prototype.invert=function(){return this.options.invert=!0,this},Mocha.prototype.ignoreLeaks=function(ignore){return this.options.ignoreLeaks=!!ignore,this},Mocha.prototype.checkLeaks=function(){return this.options.ignoreLeaks=!1,this},Mocha.prototype.growl=function(){return this.options.growl=!0,this},Mocha.prototype.globals=function(globals){return this.options.globals=(this.options.globals||[]).concat(globals),this},Mocha.prototype.useColors=function(colors){return this.options.useColors=arguments.length&&void 0!=colors?colors:!0,this},Mocha.prototype.useInlineDiffs=function(inlineDiffs){return this.options.useInlineDiffs=arguments.length&&void 0!=inlineDiffs&&inlineDiffs,this},Mocha.prototype.timeout=function(timeout){return this.suite.timeout(timeout),this},Mocha.prototype.slow=function(slow){return this.suite.slow(slow),this},Mocha.prototype.enableTimeouts=function(enabled){return this.suite.enableTimeouts(arguments.length&&void 0!==enabled?enabled:!0),this},Mocha.prototype.asyncOnly=function(){return this.options.asyncOnly=!0,this},Mocha.prototype.noHighlighting=function(){return this.options.noHighlighting=!0,this},Mocha.prototype.run=function(fn){this.files.length&&this.loadFiles();var suite=this.suite,options=this.options;options.files=this.files;var runner=new exports.Runner(suite),reporter=new this._reporter(runner,options);return runner.ignoreLeaks=!1!==options.ignoreLeaks,runner.asyncOnly=options.asyncOnly,options.grep&&runner.grep(options.grep,options.invert),options.globals&&runner.globals(options.globals),options.growl&&this._growl(runner,reporter),exports.reporters.Base.useColors=options.useColors,exports.reporters.Base.inlineDiffs=options.useInlineDiffs,runner.run(fn)}}),require.register('ms.js',function(module,exports,require){function parse(str){var match=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(str);if(match){var n=parseFloat(match[1]),type=(match[2]||'ms').toLowerCase();return'years'===type||'year'===type||'y'===type?n*y:'days'===type||'day'===type||'d'===type?n*d:'hours'===type||'hour'===type||'h'===type?n*h:'minutes'===type||'minute'===type||'m'===type?n*m:'seconds'===type||'second'===type||'s'===type?n*s:'ms'===type?n:void 0}}function shortFormat(ms){var _Mathround=Math.round;return ms>=d?_Mathround(ms/d)+'d':ms>=h?_Mathround(ms/h)+'h':ms>=m?_Mathround(ms/m)+'m':ms>=s?_Mathround(ms/s)+'s':ms+'ms'}function longFormat(ms){return plural(ms,d,'day')||plural(ms,h,'hour')||plural(ms,m,'minute')||plural(ms,s,'second')||ms+' ms'}function plural(ms,n,name){return ms<n?void 0:ms<1.5*n?_Mathfloor(ms/n)+' '+name:Math.ceil(ms/n)+' '+name+'s'}var s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;module.exports=function(val,options){return options=options||{},'string'==typeof val?parse(val):options.long?longFormat(val):shortFormat(val)}}),require.register('reporters/base.js',function(module,exports,require){function Base(runner){var self=this,stats=this.stats={suites:0,tests:0,passes:0,pending:0,failures:0},failures=this.failures=[];runner&&(this.runner=runner,runner.stats=stats,runner.on('start',function(){stats.start=new Date}),runner.on('suite',function(suite){stats.suites=stats.suites||0,suite.root||stats.suites++}),runner.on('test end',function(test){stats.tests=stats.tests||0,stats.tests++}),runner.on('pass',function(test){stats.passes=stats.passes||0;var medium=test.slow()/2;test.speed=test.duration>test.slow()?'slow':test.duration>medium?'medium':'fast',stats.passes++}),runner.on('fail',function(test,err){stats.failures=stats.failures||0,stats.failures++,test.err=err,failures.push(test)}),runner.on('end',function(){stats.end=new Date,stats.duration=new Date-stats.start}),runner.on('pending',function(){stats.pending++}))}function pad(str,len){return str+='',Array(len-str.length+1).join(' ')+str}function inlineDiff(err,escape){var msg=errorDiff(err,'WordsWithSpace',escape),lines=msg.split('\n');if(4<lines.length){var width=(lines.length+'').length;msg=lines.map(function(str,i){return pad(++i,width)+' | '+str}).join('\n')}return msg='\n'+color('diff removed','actual')+' '+color('diff added','expected')+'\n\n'+msg+'\n',msg=msg.replace(/^/gm,'      '),msg}function unifiedDiff(err,escape){function cleanUp(line){return escape&&(line=escapeInvisibles(line)),'+'===line[0]?indent+colorLines('diff added',line):'-'===line[0]?indent+colorLines('diff removed',line):line.match(/\@\@/)?null:line.match(/\\ No newline/)?null:indent+line}function notBlank(line){return null!=line}var indent='      ';msg=diff.createPatch('string',err.actual,err.expected);var lines=msg.split('\n').splice(4);return'\n      '+colorLines('diff added','+ expected')+' '+colorLines('diff removed','- actual')+'\n\n'+lines.map(cleanUp).filter(notBlank).join('\n')}function errorDiff(err,type,escape){var actual=escape?escapeInvisibles(err.actual):err.actual,expected=escape?escapeInvisibles(err.expected):err.expected;return diff['diff'+type](actual,expected).map(function(str){return str.added?colorLines('diff added',str.value):str.removed?colorLines('diff removed',str.value):str.value}).join('')}function escapeInvisibles(line){return line.replace(/\t/g,'<tab>').replace(/\r/g,'<CR>').replace(/\n/g,'<LF>\n')}function colorLines(name,str){return str.split('\n').map(function(str){return color(name,str)}).join('\n')}function sameType(a,b){return a=Object.prototype.toString.call(a),b=Object.prototype.toString.call(b),a==b}var tty=require('browser/tty'),diff=require('browser/diff'),ms=require('../ms'),utils=require('../utils'),Date=global.Date,setTimeout=global.setTimeout,setInterval=global.setInterval,clearTimeout=global.clearTimeout,clearInterval=global.clearInterval,isatty=tty.isatty(1)&&tty.isatty(2);exports=module.exports=Base,exports.useColors=isatty||process.env.MOCHA_COLORS!==void 0,exports.inlineDiffs=!1,exports.colors={pass:90,fail:31,"bright pass":92,"bright fail":91,"bright yellow":93,pending:36,suite:0,"error title":0,"error message":31,"error stack":90,checkmark:32,fast:90,medium:33,slow:31,green:32,light:90,"diff gutter":90,"diff added":42,"diff removed":41},exports.symbols={ok:'\u2713',err:'\u2716',dot:'\u2024'},'win32'==process.platform&&(exports.symbols.ok='\u221A',exports.symbols.err='\xD7',exports.symbols.dot='.');var color=exports.color=function(type,str){return exports.useColors?'\x1B['+exports.colors[type]+'m'+str+'\x1B[0m':str};exports.window={width:isatty?process.stdout.getWindowSize?process.stdout.getWindowSize(1)[0]:tty.getWindowSize()[1]:75},exports.cursor={hide:function(){isatty&&process.stdout.write('\x1B[?25l')},show:function(){isatty&&process.stdout.write('\x1B[?25h')},deleteLine:function(){isatty&&process.stdout.write('\x1B[2K')},beginningOfLine:function(){isatty&&process.stdout.write('\x1B[0G')},CR:function(){isatty?(exports.cursor.deleteLine(),exports.cursor.beginningOfLine()):process.stdout.write('\r')}},exports.list=function(failures){console.error(),failures.forEach(function(test,i){var fmt=color('error title','  %s) %s:\n')+color('error message','     %s')+color('error stack','\n%s\n'),err=test.err,message=err.message||'',stack=err.stack||message,index=stack.indexOf(message)+message.length,msg=stack.slice(0,index),actual=err.actual,expected=err.expected,escape=!0;if(err.uncaught&&(msg='Uncaught '+msg),err.showDiff&&sameType(actual,expected)&&(escape=!1,err.actual=actual=utils.stringify(actual),err.expected=expected=utils.stringify(expected)),err.showDiff&&'string'==typeof actual&&'string'==typeof expected){fmt=color('error title','  %s) %s:\n%s')+color('error stack','\n%s\n');var match=message.match(/^([^:]+): expected/);msg='\n      '+color('error message',match?match[1]:msg),msg+=exports.inlineDiffs?inlineDiff(err,escape):unifiedDiff(err,escape)}stack=stack.slice(index?index+1:index).replace(/^/gm,'  '),console.error(fmt,i+1,test.fullTitle(),msg,stack)})},Base.prototype.epilogue=function(){var tests,fmt,stats=this.stats;console.log(),fmt=color('bright pass',' ')+color('green',' %d passing')+color('light',' (%s)'),console.log(fmt,stats.passes||0,ms(stats.duration)),stats.pending&&(fmt=color('pending',' ')+color('pending',' %d pending'),console.log(fmt,stats.pending)),stats.failures&&(fmt=color('fail','  %d failing'),console.error(fmt,stats.failures),Base.list(this.failures),console.error()),console.log()}}),require.register('reporters/doc.js',function(module,exports,require){function Doc(runner){function indent(){return Array(indents).join('  ')}Base.call(this,runner);var self=this,stats=this.stats,total=runner.total,indents=2;runner.on('suite',function(suite){suite.root||(++indents,console.log('%s<section class="suite">',indent()),++indents,console.log('%s<h1>%s</h1>',indent(),utils.escape(suite.title)),console.log('%s<dl>',indent()))}),runner.on('suite end',function(suite){suite.root||(console.log('%s</dl>',indent()),--indents,console.log('%s</section>',indent()),--indents)}),runner.on('pass',function(test){console.log('%s  <dt>%s</dt>',indent(),utils.escape(test.title));var code=utils.escape(utils.clean(test.fn.toString()));console.log('%s  <dd><pre><code>%s</code></pre></dd>',indent(),code)}),runner.on('fail',function(test,err){console.log('%s  <dt class="error">%s</dt>',indent(),utils.escape(test.title));var code=utils.escape(utils.clean(test.fn.toString()));console.log('%s  <dd class="error"><pre><code>%s</code></pre></dd>',indent(),code),console.log('%s  <dd class="error">%s</dd>',indent(),utils.escape(err))})}var Base=require('./base'),utils=require('../utils');exports=module.exports=Doc}),require.register('reporters/dot.js',function(module,exports,require){function Dot(runner){Base.call(this,runner);var self=this,stats=this.stats,width=0|.75*Base.window.width,n=-1;runner.on('start',function(){process.stdout.write('\n  ')}),runner.on('pending',function(test){0==++n%width&&process.stdout.write('\n  '),process.stdout.write(color('pending',Base.symbols.dot))}),runner.on('pass',function(test){0==++n%width&&process.stdout.write('\n  '),'slow'==test.speed?process.stdout.write(color('bright yellow',Base.symbols.dot)):process.stdout.write(color(test.speed,Base.symbols.dot))}),runner.on('fail',function(test,err){0==++n%width&&process.stdout.write('\n  '),process.stdout.write(color('fail',Base.symbols.dot))}),runner.on('end',function(){console.log(),self.epilogue()})}function F(){}var Base=require('./base'),color=Base.color;exports=module.exports=Dot;;F.prototype=Base.prototype,Dot.prototype=new F,Dot.prototype.constructor=Dot}),require.register('reporters/html-cov.js',function(module,exports,require){function HTMLCov(runner){var jade=require('jade'),file=__dirname+'/templates/coverage.jade',str=fs.readFileSync(file,'utf8'),fn=jade.compile(str,{filename:file}),self=this;JSONCov.call(this,runner,!1),runner.on('end',function(){process.stdout.write(fn({cov:self.cov,coverageClass:coverageClass}))})}function coverageClass(n){return 75<=n?'high':50<=n?'medium':25<=n?'low':'terrible'}var JSONCov=require('./json-cov'),fs=require('browser/fs');exports=module.exports=HTMLCov}),require.register('reporters/html.js',function(module,exports,require){function HTML(runner){Base.call(this,runner);var progress,ctx,self=this,stats=this.stats,total=runner.total,stat=fragment(statsTemplate),items=stat.getElementsByTagName('li'),passes=items[1].getElementsByTagName('em')[0],passesLink=items[1].getElementsByTagName('a')[0],failures=items[2].getElementsByTagName('em')[0],failuresLink=items[2].getElementsByTagName('a')[0],duration=items[3].getElementsByTagName('em')[0],canvas=stat.getElementsByTagName('canvas')[0],report=fragment('<ul id="mocha-report"></ul>'),stack=[report],root=document.getElementById('mocha');if(canvas.getContext){var ratio=window.devicePixelRatio||1;canvas.style.width=canvas.width,canvas.style.height=canvas.height,canvas.width*=ratio,canvas.height*=ratio,ctx=canvas.getContext('2d'),ctx.scale(ratio,ratio),progress=new Progress}return root?void(on(passesLink,'click',function(){unhide();var name=/pass/.test(report.className)?'':' pass';report.className=report.className.replace(/fail|pass/g,'')+name,report.className.trim()&&hideSuitesWithout('test pass')}),on(failuresLink,'click',function(){unhide();var name=/fail/.test(report.className)?'':' fail';report.className=report.className.replace(/fail|pass/g,'')+name,report.className.trim()&&hideSuitesWithout('test fail')}),root.appendChild(stat),root.appendChild(report),progress&&progress.size(40),runner.on('suite',function(suite){if(!suite.root){var url=self.suiteURL(suite),el=fragment('<li class="suite"><h1><a href="%s">%s</a></h1></li>',url,escape(suite.title));stack[0].appendChild(el),stack.unshift(document.createElement('ul')),el.appendChild(stack[0])}}),runner.on('suite end',function(suite){suite.root||stack.shift()}),runner.on('fail',function(test,err){'hook'==test.type&&runner.emit('test end',test)}),runner.on('test end',function(test){var percent=0|100*(stats.tests/this.total);progress&&progress.update(percent).draw(ctx);var ms=new Date-stats.start;if(text(passes,stats.passes),text(failures,stats.failures),text(duration,(ms/1e3).toFixed(2)),'passed'==test.state)var url=self.testURL(test),el=fragment('<li class="test pass %e"><h2>%e<span class="duration">%ems</span> <a href="%s" class="replay">\u2023</a></h2></li>',test.speed,test.title,test.duration,url);else if(test.pending)var el=fragment('<li class="test pass pending"><h2>%e</h2></li>',test.title);else{var el=fragment('<li class="test fail"><h2>%e <a href="?grep=%e" class="replay">\u2023</a></h2></li>',test.title,encodeURIComponent(test.fullTitle())),str=test.err.stack||test.err.toString();~str.indexOf(test.err.message)||(str=test.err.message+'\n'+str),'[object Error]'==str&&(str=test.err.message),!test.err.stack&&test.err.sourceURL&&void 0!==test.err.line&&(str+='\n('+test.err.sourceURL+':'+test.err.line+')'),el.appendChild(fragment('<pre class="error">%e</pre>',str))}if(!test.pending){var h2=el.getElementsByTagName('h2')[0];on(h2,'click',function(){pre.style.display='none'==pre.style.display?'block':'none'});var pre=fragment('<pre><code>%e</code></pre>',utils.clean(test.fn.toString()));el.appendChild(pre),pre.style.display='none'}stack[0]&&stack[0].appendChild(el)})):error('#mocha div missing, add it to your document')}function error(msg){document.body.appendChild(fragment('<div id="mocha-error">%s</div>',msg))}function fragment(html){var args=arguments,div=document.createElement('div'),i=1;return div.innerHTML=html.replace(/%([se])/g,function(_,type){return's'===type?args[i++]+'':'e'===type?escape(args[i++]):void 0}),div.firstChild}function hideSuitesWithout(classname){for(var els,suites=document.getElementsByClassName('suite'),i=0;i<suites.length;i++)els=suites[i].getElementsByClassName(classname),0==els.length&&(suites[i].className+=' hidden')}function unhide(){for(var els=document.getElementsByClassName('suite hidden'),i=0;i<els.length;++i)els[i].className=els[i].className.replace('suite hidden','suite')}function text(el,str){el.textContent?el.textContent=str:el.innerText=str}function on(el,event,fn){el.addEventListener?el.addEventListener(event,fn,!1):el.attachEvent('on'+event,fn)}var Base=require('./base'),utils=require('../utils'),Progress=require('../browser/progress'),escape=utils.escape,Date=global.Date,setTimeout=global.setTimeout,setInterval=global.setInterval,clearTimeout=global.clearTimeout,clearInterval=global.clearInterval;exports=module.exports=HTML;var statsTemplate='<ul id="mocha-stats"><li class="progress"><canvas width="40" height="40"></canvas></li><li class="passes"><a href="#">passes:</a> <em>0</em></li><li class="failures"><a href="#">failures:</a> <em>0</em></li><li class="duration">duration: <em>0</em>s</li></ul>';HTML.prototype.suiteURL=function(suite){return'?grep='+encodeURIComponent(suite.fullTitle())},HTML.prototype.testURL=function(test){return'?grep='+encodeURIComponent(test.fullTitle())}}),require.register('reporters/index.js',function(module,exports,require){exports.Base=require('./base'),exports.Dot=require('./dot'),exports.Doc=require('./doc'),exports.TAP=require('./tap'),exports.JSON=require('./json'),exports.HTML=require('./html'),exports.List=require('./list'),exports.Min=require('./min'),exports.Spec=require('./spec'),exports.Nyan=require('./nyan'),exports.XUnit=require('./xunit'),exports.Markdown=require('./markdown'),exports.Progress=require('./progress'),exports.Landing=require('./landing'),exports.JSONCov=require('./json-cov'),exports.HTMLCov=require('./html-cov'),exports.JSONStream=require('./json-stream')}),require.register('reporters/json-cov.js',function(module,exports,require){function JSONCov(runner,output){var self=this,output=!(1!=arguments.length)||output;Base.call(this,runner);var tests=[],failures=[],passes=[];runner.on('test end',function(test){tests.push(test)}),runner.on('pass',function(test){passes.push(test)}),runner.on('fail',function(test){failures.push(test)}),runner.on('end',function(){var cov=global._$jscoverage||{},result=self.cov=map(cov);result.stats=self.stats,result.tests=tests.map(clean),result.failures=failures.map(clean),result.passes=passes.map(clean);output&&process.stdout.write(JSON.stringify(result,null,2))})}function map(cov){var ret={instrumentation:'node-jscoverage',sloc:0,hits:0,misses:0,coverage:0,files:[]};for(var filename in cov){var data=coverage(filename,cov[filename]);ret.files.push(data),ret.hits+=data.hits,ret.misses+=data.misses,ret.sloc+=data.sloc}return ret.files.sort(function(a,b){return a.filename.localeCompare(b.filename)}),0<ret.sloc&&(ret.coverage=100*(ret.hits/ret.sloc)),ret}function coverage(filename,data){var ret={filename:filename,coverage:0,hits:0,misses:0,sloc:0,source:{}};return data.source.forEach(function(line,num){num++,0===data[num]?(ret.misses++,ret.sloc++):void 0!==data[num]&&(ret.hits++,ret.sloc++),ret.source[num]={source:line,coverage:void 0===data[num]?'':data[num]}}),ret.coverage=100*(ret.hits/ret.sloc),ret}function clean(test){return{title:test.title,fullTitle:test.fullTitle(),duration:test.duration}}var Base=require('./base');exports=module.exports=JSONCov}),require.register('reporters/json-stream.js',function(module,exports,require){function List(runner){Base.call(this,runner);var self=this,stats=this.stats,total=runner.total;runner.on('start',function(){console.log(JSON.stringify(['start',{total:total}]))}),runner.on('pass',function(test){console.log(JSON.stringify(['pass',clean(test)]))}),runner.on('fail',function(test,err){console.log(JSON.stringify(['fail',clean(test)]))}),runner.on('end',function(){process.stdout.write(JSON.stringify(['end',self.stats]))})}function clean(test){return{title:test.title,fullTitle:test.fullTitle(),duration:test.duration}}var Base=require('./base'),color=Base.color;exports=module.exports=List}),require.register('reporters/json.js',function(module,exports,require){function JSONReporter(runner){var self=this;Base.call(this,runner);var tests=[],pending=[],failures=[],passes=[];runner.on('test end',function(test){tests.push(test)}),runner.on('pass',function(test){passes.push(test)}),runner.on('fail',function(test){failures.push(test)}),runner.on('pending',function(test){pending.push(test)}),runner.on('end',function(){var obj={stats:self.stats,tests:tests.map(clean),pending:pending.map(clean),failures:failures.map(clean),passes:passes.map(clean)};runner.testResults=obj,process.stdout.write(JSON.stringify(obj,null,2))})}function clean(test){return{title:test.title,fullTitle:test.fullTitle(),duration:test.duration,err:errorJSON(test.err||{})}}function errorJSON(err){var res={};return Object.getOwnPropertyNames(err).forEach(function(key){res[key]=err[key]},err),res}var Base=require('./base'),cursor=Base.cursor,color=Base.color;exports=module.exports=JSONReporter}),require.register('reporters/landing.js',function(module,exports,require){function Landing(runner){function runway(){var buf=Array(width).join('-');return'  '+color('runway',buf)}Base.call(this,runner);var self=this,stats=this.stats,width=0|.75*Base.window.width,total=runner.total,stream=process.stdout,plane=color('plane','\u2708'),crashed=-1,n=0;runner.on('start',function(){stream.write('\n  '),cursor.hide()}),runner.on('test end',function(test){var col=-1==crashed?0|width*++n/total:crashed;'failed'==test.state&&(plane=color('plane crash','\u2708'),crashed=col),stream.write('\x1B[4F\n\n'),stream.write(runway()),stream.write('\n  '),stream.write(color('runway',Array(col).join('\u22C5'))),stream.write(plane),stream.write(color('runway',Array(width-col).join('\u22C5')+'\n')),stream.write(runway()),stream.write('\x1B[0m')}),runner.on('end',function(){cursor.show(),console.log(),self.epilogue()})}function F(){}var Base=require('./base'),cursor=Base.cursor,color=Base.color;exports=module.exports=Landing,Base.colors.plane=0,Base.colors['plane crash']=31,Base.colors.runway=90;;F.prototype=Base.prototype,Landing.prototype=new F,Landing.prototype.constructor=Landing}),require.register('reporters/list.js',function(module,exports,require){function List(runner){Base.call(this,runner);var self=this,stats=this.stats,n=0;runner.on('start',function(){console.log()}),runner.on('test',function(test){process.stdout.write(color('pass','    '+test.fullTitle()+': '))}),runner.on('pending',function(test){var fmt=color('checkmark','  -')+color('pending',' %s');console.log(fmt,test.fullTitle())}),runner.on('pass',function(test){var fmt=color('checkmark','  '+Base.symbols.dot)+color('pass',' %s: ')+color(test.speed,'%dms');cursor.CR(),console.log(fmt,test.fullTitle(),test.duration)}),runner.on('fail',function(test,err){cursor.CR(),console.log(color('fail','  %d) %s'),++n,test.fullTitle())}),runner.on('end',self.epilogue.bind(self))}function F(){}var Base=require('./base'),cursor=Base.cursor,color=Base.color;exports=module.exports=List;;F.prototype=Base.prototype,List.prototype=new F,List.prototype.constructor=List}),require.register('reporters/markdown.js',function(module,exports,require){function Markdown(runner){function title(str){return Array(level).join('#')+' '+str}function indent(){return Array(level).join('  ')}function mapTOC(suite,obj){var ret=obj;return obj=obj[suite.title]=obj[suite.title]||{suite:suite},suite.suites.forEach(function(suite){mapTOC(suite,obj)}),ret}function stringifyTOC(obj,level){++level;var link,buf='';for(var key in obj)'suite'!=key&&(key&&(link=' - ['+key+'](#'+utils.slug(obj[key].suite.fullTitle())+')\n'),key&&(buf+=Array(level).join('  ')+link),buf+=stringifyTOC(obj[key],level));return--level,buf}function generateTOC(suite){var obj=mapTOC(suite,{});return stringifyTOC(obj,0)}Base.call(this,runner);var self=this,stats=this.stats,level=0,buf='';generateTOC(runner.suite),runner.on('suite',function(suite){++level;var slug=utils.slug(suite.fullTitle());buf+='<a name="'+slug+'"></a>\n',buf+=title(suite.title)+'\n'}),runner.on('suite end',function(suite){--level}),runner.on('pass',function(test){var code=utils.clean(test.fn.toString());buf+=test.title+'.\n',buf+='\n```js\n',buf+=code+'\n',buf+='```\n\n'}),runner.on('end',function(){process.stdout.write('# TOC\n'),process.stdout.write(generateTOC(runner.suite)),process.stdout.write(buf)})}var Base=require('./base'),utils=require('../utils');exports=module.exports=Markdown}),require.register('reporters/min.js',function(module,exports,require){function Min(runner){Base.call(this,runner),runner.on('start',function(){process.stdout.write('\x1B[2J'),process.stdout.write('\x1B[1;3H')}),runner.on('end',this.epilogue.bind(this))}function F(){}var Base=require('./base');exports=module.exports=Min;;F.prototype=Base.prototype,Min.prototype=new F,Min.prototype.constructor=Min}),require.register('reporters/nyan.js',function(module,exports,require){function NyanCat(runner){Base.call(this,runner);var self=this,stats=this.stats,width=0|.75*Base.window.width,rainbowColors=this.rainbowColors=self.generateColors(),colorIndex=this.colorIndex=0,numerOfLines=this.numberOfLines=4,trajectories=this.trajectories=[[],[],[],[]],nyanCatWidth=this.nyanCatWidth=11,trajectoryWidthMax=this.trajectoryWidthMax=width-nyanCatWidth,scoreboardWidth=this.scoreboardWidth=5,tick=this.tick=0,n=0;runner.on('start',function(){Base.cursor.hide(),self.draw()}),runner.on('pending',function(test){self.draw()}),runner.on('pass',function(test){self.draw()}),runner.on('fail',function(test,err){self.draw()}),runner.on('end',function(){Base.cursor.show();for(var i=0;i<self.numberOfLines;i++)write('\n');self.epilogue()})}function write(string){process.stdout.write(string)}function F(){}var Base=require('./base'),color=Base.color;exports=module.exports=NyanCat,NyanCat.prototype.draw=function(){this.appendRainbow(),this.drawScoreboard(),this.drawRainbow(),this.drawNyanCat(),this.tick=!this.tick},NyanCat.prototype.drawScoreboard=function(){function draw(color,n){write(' '),write('\x1B['+color+'m'+n+'\x1B[0m'),write('\n')}var stats=this.stats,colors=Base.colors;draw(colors.green,stats.passes),draw(colors.fail,stats.failures),draw(colors.pending,stats.pending),write('\n'),this.cursorUp(this.numberOfLines)},NyanCat.prototype.appendRainbow=function(){for(var trajectory,segment=this.tick?'_':'-',rainbowified=this.rainbowify(segment),index=0;index<this.numberOfLines;index++)trajectory=this.trajectories[index],trajectory.length>=this.trajectoryWidthMax&&trajectory.shift(),trajectory.push(rainbowified)},NyanCat.prototype.drawRainbow=function(){var self=this;this.trajectories.forEach(function(line,index){write('\x1B['+self.scoreboardWidth+'C'),write(line.join('')),write('\n')}),this.cursorUp(this.numberOfLines)},NyanCat.prototype.drawNyanCat=function(){var self=this,startWidth=this.scoreboardWidth+this.trajectories[0].length,color='\x1B['+startWidth+'C',padding='';write(color),write('_,------,'),write('\n'),write(color),padding=self.tick?'  ':'   ',write('_|'+padding+'/\\_/\\ '),write('\n'),write(color),padding=self.tick?'_':'__';var face,tail=self.tick?'~':'^';write(tail+'|'+padding+this.face()+' '),write('\n'),write(color),padding=self.tick?' ':'  ',write(padding+'""  "" '),write('\n'),this.cursorUp(this.numberOfLines)},NyanCat.prototype.face=function(){var stats=this.stats;return stats.failures?'( x .x)':stats.pending?'( o .o)':stats.passes?'( ^ .^)':'( - .-)'},NyanCat.prototype.cursorUp=function(n){write('\x1B['+n+'A')},NyanCat.prototype.cursorDown=function(n){write('\x1B['+n+'B')},NyanCat.prototype.generateColors=function(){for(var _Mathsin=Math.sin,colors=[],i=0;i<42;i++){var pi3=_Mathfloor(_MathPI/3),n=i*(1/6),r=_Mathfloor(3*_Mathsin(n)+3),g=_Mathfloor(3*_Mathsin(n+2*pi3)+3),b=_Mathfloor(3*_Mathsin(n+4*pi3)+3);colors.push(36*r+6*g+b+16)}return colors},NyanCat.prototype.rainbowify=function(str){var color=this.rainbowColors[this.colorIndex%this.rainbowColors.length];return this.colorIndex+=1,'\x1B[38;5;'+color+'m'+str+'\x1B[0m'};;F.prototype=Base.prototype,NyanCat.prototype=new F,NyanCat.prototype.constructor=NyanCat}),require.register('reporters/progress.js',function(module,exports,require){function Progress(runner,options){Base.call(this,runner);var self=this,options=options||{},stats=this.stats,width=0|0.5*Base.window.width,total=runner.total,complete=0,max=Math.max,lastN=-1;options.open=options.open||'[',options.complete=options.complete||'\u25AC',options.incomplete=options.incomplete||Base.symbols.dot,options.close=options.close||']',options.verbose=!1,runner.on('start',function(){console.log(),cursor.hide()}),runner.on('test end',function(){complete++;var incomplete=total-complete,percent=complete/total,n=0|width*percent,i=width-n;(lastN!=n||options.verbose)&&(lastN=n,cursor.CR(),process.stdout.write('\x1B[J'),process.stdout.write(color('progress','  '+options.open)),process.stdout.write(Array(n).join(options.complete)),process.stdout.write(Array(i).join(options.incomplete)),process.stdout.write(color('progress',options.close)),options.verbose&&process.stdout.write(color('progress',' '+complete+' of '+total)))}),runner.on('end',function(){cursor.show(),console.log(),self.epilogue()})}function F(){}var Base=require('./base'),cursor=Base.cursor,color=Base.color;exports=module.exports=Progress,Base.colors.progress=90;;F.prototype=Base.prototype,Progress.prototype=new F,Progress.prototype.constructor=Progress}),require.register('reporters/spec.js',function(module,exports,require){function Spec(runner){function indent(){return Array(indents).join('  ')}Base.call(this,runner);var self=this,stats=this.stats,indents=0,n=0;runner.on('start',function(){console.log()}),runner.on('suite',function(suite){++indents,console.log(color('suite','%s%s'),indent(),suite.title)}),runner.on('suite end',function(suite){--indents,1==indents&&console.log()}),runner.on('pending',function(test){var fmt=indent()+color('pending','  - %s');console.log(fmt,test.title)}),runner.on('pass',function(test){if('fast'==test.speed){var fmt=indent()+color('checkmark','  '+Base.symbols.ok)+color('pass',' %s ');cursor.CR(),console.log(fmt,test.title)}else{var fmt=indent()+color('checkmark','  '+Base.symbols.ok)+color('pass',' %s ')+color(test.speed,'(%dms)');cursor.CR(),console.log(fmt,test.title,test.duration)}}),runner.on('fail',function(test,err){cursor.CR(),console.log(indent()+color('fail','  %d) %s'),++n,test.title)}),runner.on('end',self.epilogue.bind(self))}function F(){}var Base=require('./base'),cursor=Base.cursor,color=Base.color;exports=module.exports=Spec;;F.prototype=Base.prototype,Spec.prototype=new F,Spec.prototype.constructor=Spec}),require.register('reporters/tap.js',function(module,exports,require){function TAP(runner){Base.call(this,runner);var self=this,stats=this.stats,n=1,passes=0,failures=0;runner.on('start',function(){var total=runner.grepTotal(runner.suite);console.log('%d..%d',1,total)}),runner.on('test end',function(){++n}),runner.on('pending',function(test){console.log('ok %d %s # SKIP -',n,title(test))}),runner.on('pass',function(test){passes++,console.log('ok %d %s',n,title(test))}),runner.on('fail',function(test,err){failures++,console.log('not ok %d %s',n,title(test)),err.stack&&console.log(err.stack.replace(/^/gm,'  '))}),runner.on('end',function(){console.log('# tests '+(passes+failures)),console.log('# pass '+passes),console.log('# fail '+failures)})}function title(test){return test.fullTitle().replace(/#/g,'')}var Base=require('./base'),cursor=Base.cursor,color=Base.color;exports=module.exports=TAP}),require.register('reporters/xunit.js',function(module,exports,require){function XUnit(runner){Base.call(this,runner);var stats=this.stats,tests=[],self=this;runner.on('pending',function(test){tests.push(test)}),runner.on('pass',function(test){tests.push(test)}),runner.on('fail',function(test){tests.push(test)}),runner.on('end',function(){console.log(tag('testsuite',{name:'Mocha Tests',tests:stats.tests,failures:stats.failures,errors:stats.failures,skipped:stats.tests-stats.failures-stats.passes,timestamp:new Date().toUTCString(),time:stats.duration/1e3||0},!1)),tests.forEach(test),console.log('</testsuite>')})}function F(){}function test(test){var attrs={classname:test.parent.fullTitle(),name:test.title,time:test.duration/1e3||0};if('failed'==test.state){var err=test.err;console.log(tag('testcase',attrs,!1,tag('failure',{},!1,cdata(escape(err.message)+'\n'+err.stack))))}else test.pending?console.log(tag('testcase',attrs,!1,tag('skipped',{},!0))):console.log(tag('testcase',attrs,!0))}function tag(name,attrs,close,content){var tag,end=close?'/>':'>',pairs=[];for(var key in attrs)pairs.push(key+'="'+escape(attrs[key])+'"');return tag='<'+name+(pairs.length?' '+pairs.join(' '):'')+end,content&&(tag+=content+'</'+name+end),tag}function cdata(str){return'<![CDATA['+escape(str)+']]>'}var Base=require('./base'),utils=require('../utils'),escape=utils.escape,Date=global.Date,setTimeout=global.setTimeout,setInterval=global.setInterval,clearTimeout=global.clearTimeout,clearInterval=global.clearInterval;exports=module.exports=XUnit;;F.prototype=Base.prototype,XUnit.prototype=new F,XUnit.prototype.constructor=XUnit}),require.register('runnable.js',function(module,exports,require){function Runnable(title,fn){this.title=title,this.fn=fn,this.async=fn&&fn.length,this.sync=!this.async,this._timeout=2e3,this._slow=75,this._enableTimeouts=!0,this.timedOut=!1}function F(){}var EventEmitter=require('browser/events').EventEmitter,debug=require('browser/debug')('mocha:runnable'),milliseconds=require('./ms'),Date=global.Date,setTimeout=global.setTimeout,setInterval=global.setInterval,clearTimeout=global.clearTimeout,clearInterval=global.clearInterval,toString=Object.prototype.toString;module.exports=Runnable;;F.prototype=EventEmitter.prototype,Runnable.prototype=new F,Runnable.prototype.constructor=Runnable,Runnable.prototype.timeout=function(ms){return 0==arguments.length?this._timeout:(0===ms&&(this._enableTimeouts=!1),'string'==typeof ms&&(ms=milliseconds(ms)),debug('timeout %d',ms),this._timeout=ms,this.timer&&this.resetTimeout(),this)},Runnable.prototype.slow=function(ms){return 0===arguments.length?this._slow:('string'==typeof ms&&(ms=milliseconds(ms)),debug('timeout %d',ms),this._slow=ms,this)},Runnable.prototype.enableTimeouts=function(enabled){return 0===arguments.length?this._enableTimeouts:(debug('enableTimeouts %s',enabled),this._enableTimeouts=enabled,this)},Runnable.prototype.fullTitle=function(){return this.parent.fullTitle()+' '+this.title},Runnable.prototype.clearTimeout=function(){clearTimeout(this.timer)},Runnable.prototype.inspect=function(){return JSON.stringify(this,function(key,val){return'_'==key[0]?void 0:'parent'==key?'#<Suite>':'ctx'==key?'#<Context>':val},2)},Runnable.prototype.resetTimeout=function(){var self=this,ms=this.timeout()||1e9;this._enableTimeouts&&(this.clearTimeout(),this.timer=setTimeout(function(){self._enableTimeouts&&(self.callback(new Error('timeout of '+ms+'ms exceeded')),self.timedOut=!0)},ms))},Runnable.prototype.globals=function(arr){var self=this;this._allowedGlobals=arr},Runnable.prototype.run=function(fn){function multiple(err){emitted||(emitted=!0,self.emit('error',err||new Error('done() called multiple times')))}function done(err){var ms=self.timeout();return self.timedOut?void 0:finished?multiple(err):void(self.clearTimeout(),self.duration=new Date-start,finished=!0,!err&&self.duration>ms&&self._enableTimeouts&&(err=new Error('timeout of '+ms+'ms exceeded')),fn(err))}function callFn(fn){var result=fn.call(ctx);result&&'function'==typeof result.then?(self.resetTimeout(),result.then(function(){done()},function(reason){done(reason||new Error('Promise rejected with no or falsy reason'))})):done()}var finished,emitted,self=this,start=new Date,ctx=this.ctx;if(ctx&&ctx.runnable&&ctx.runnable(this),this.callback=done,this.async){this.resetTimeout();try{this.fn.call(ctx,function(err){return err instanceof Error||'[object Error]'===toString.call(err)?done(err):null==err?void done():'[object Object]'===Object.prototype.toString.call(err)?done(new Error('done() invoked with non-Error: '+JSON.stringify(err))):done(new Error('done() invoked with non-Error: '+err))})}catch(err){done(err)}return}if(this.asyncOnly)return done(new Error('--async-only option in use without declaring `done()`'));try{this.pending?done():callFn(this.fn)}catch(err){done(err)}}}),require.register('runner.js',function(module,exports,require){function Runner(suite){var self=this;this._globals=[],this._abort=!1,this.suite=suite,this.total=suite.total(),this.failures=0,this.on('test end',function(test){self.checkGlobals(test)}),this.on('hook end',function(hook){self.checkGlobals(hook)}),this.grep(/.*/),this.globals(this.globalProps().concat(extraGlobals()))}function F(){}function filterLeaks(ok,globals){return filter(globals,function(key){if(/^d+/.test(key))return!1;if(global.navigator&&/^getInterface/.test(key))return!1;if(global.navigator&&/^\d+/.test(key))return!1;if(/^mocha-/.test(key))return!1;var matched=filter(ok,function(ok){return~ok.indexOf('*')?0==key.indexOf(ok.split('*')[0]):key==ok});return 0==matched.length&&(!global.navigator||'onerror'!==key)})}function extraGlobals(){if('object'==typeof process&&'string'==typeof process.version){var nodeVersion=process.version.split('.').reduce(function(a,v){return a<<8|v});if(2315>nodeVersion)return['errno']}return[]}var EventEmitter=require('browser/events').EventEmitter,debug=require('browser/debug')('mocha:runner'),Test=require('./test'),utils=require('./utils'),filter=utils.filter,keys=utils.keys,globals=['setTimeout','clearTimeout','setInterval','clearInterval','XMLHttpRequest','Date'];module.exports=Runner,Runner.immediately=global.setImmediate||process.nextTick;;F.prototype=EventEmitter.prototype,Runner.prototype=new F,Runner.prototype.constructor=Runner,Runner.prototype.grep=function(re,invert){return debug('grep %s',re),this._grep=re,this._invert=invert,this.total=this.grepTotal(this.suite),this},Runner.prototype.grepTotal=function(suite){var self=this,total=0;return suite.eachTest(function(test){var match=self._grep.test(test.fullTitle());self._invert&&(match=!match),match&&total++}),total},Runner.prototype.globalProps=function(){for(var props=utils.keys(global),i=0;i<globals.length;++i)~utils.indexOf(props,globals[i])||props.push(globals[i]);return props},Runner.prototype.globals=function(arr){return 0==arguments.length?this._globals:(debug('globals %j',arr),this._globals=this._globals.concat(arr),this)},Runner.prototype.checkGlobals=function(test){if(!this.ignoreLeaks){var leaks,ok=this._globals,globals=this.globalProps();test&&(ok=ok.concat(test._allowedGlobals||[])),this.prevGlobalsLength==globals.length||(this.prevGlobalsLength=globals.length,leaks=filterLeaks(ok,globals),this._globals=this._globals.concat(leaks),1<leaks.length?this.fail(test,new Error('global leaks detected: '+leaks.join(', ')+'')):leaks.length&&this.fail(test,new Error('global leak detected: '+leaks[0])))}},Runner.prototype.fail=function(test,err){++this.failures,test.state='failed','string'==typeof err&&(err=new Error('the string "'+err+'" was thrown, throw an Error :)')),this.emit('fail',test,err)},Runner.prototype.failHook=function(hook,err){this.fail(hook,err),this.suite.bail()&&this.emit('end')},Runner.prototype.hook=function(name,fn){function next(i){var hook=hooks[i];return hook?self.failures&&suite.bail()?fn():void(self.currentRunnable=hook,hook.ctx.currentTest=self.test,self.emit('hook',hook),hook.on('error',function(err){self.failHook(hook,err)}),hook.run(function(err){hook.removeAllListeners('error');var testError=hook.error();return testError&&self.fail(self.test,testError),err?(self.failHook(hook,err),fn(err)):void(self.emit('hook end',hook),delete hook.ctx.currentTest,next(++i))})):fn()}var timer,suite=this.suite,hooks=suite['_'+name],self=this;Runner.immediately(function(){next(0)})},Runner.prototype.hooks=function(name,suites,fn){function next(suite){return self.suite=suite,suite?void self.hook(name,function(err){if(err){var errSuite=self.suite;return self.suite=orig,fn(err,errSuite)}next(suites.pop())}):(self.suite=orig,fn())}var self=this,orig=this.suite;next(suites.pop())},Runner.prototype.hookUp=function(name,fn){var suites=[this.suite].concat(this.parents()).reverse();this.hooks(name,suites,fn)},Runner.prototype.hookDown=function(name,fn){var suites=[this.suite].concat(this.parents());this.hooks(name,suites,fn)},Runner.prototype.parents=function(){for(var suite=this.suite,suites=[];suite=suite.parent;)suites.push(suite);return suites},Runner.prototype.runTest=function(fn){var test=this.test,self=this;this.asyncOnly&&(test.asyncOnly=!0);try{test.on('error',function(err){self.fail(test,err)}),test.run(fn)}catch(err){fn(err)}},Runner.prototype.runTests=function(suite,fn){function hookErr(err,errSuite,after){var orig=self.suite;self.suite=after?errSuite.parent:errSuite,self.suite?self.hookUp('afterEach',function(err2,errSuite2){return self.suite=orig,err2?hookErr(err2,errSuite2,!0):void fn(errSuite)}):(self.suite=orig,fn(errSuite))}function next(err,errSuite){if(self.failures&&suite._bail)return fn();if(self._abort)return fn();if(err)return hookErr(err,errSuite,!0);if(test=tests.shift(),!test)return fn();var match=self._grep.test(test.fullTitle());return self._invert&&(match=!match),match?test.pending?(self.emit('pending',test),self.emit('test end',test),next()):void(self.emit('test',self.test=test),self.hookDown('beforeEach',function(err,errSuite){return err?hookErr(err,errSuite,!1):void(self.currentRunnable=self.test,self.runTest(function(err){return test=self.test,err?(self.fail(test,err),self.emit('test end',test),self.hookUp('afterEach',next)):void(test.state='passed',self.emit('pass',test),self.emit('test end',test),self.hookUp('afterEach',next))}))})):next()}var test,self=this,tests=suite.tests.slice();this.next=next,next()},Runner.prototype.runSuite=function(suite,fn){function next(errSuite){if(errSuite)return errSuite==suite?done():done(errSuite);if(self._abort)return done();var curr=suite.suites[i++];return curr?void self.runSuite(curr,next):done()}function done(errSuite){self.suite=suite,self.hook('afterAll',function(){self.emit('suite end',suite),fn(errSuite)})}var total=this.grepTotal(suite),self=this,i=0;return debug('run suite %s',suite.fullTitle()),total?void(this.emit('suite',this.suite=suite),this.hook('beforeAll',function(err){return err?done():void self.runTests(suite,next)})):fn()},Runner.prototype.uncaught=function(err){err?debug('uncaught exception %s',err===function(){return this}.call(err)?err.message||err:err):(debug('uncaught undefined exception'),err=new Error('Caught undefined error, did you throw without specifying what?')),err.uncaught=!0;var runnable=this.currentRunnable;if(runnable){var wasAlreadyDone=runnable.state;return this.fail(runnable,err),runnable.clearTimeout(),wasAlreadyDone?void 0:'test'==runnable.type?(this.emit('test end',runnable),void this.hookUp('afterEach',this.next)):void this.emit('end')}},Runner.prototype.run=function(fn){function uncaught(err){self.uncaught(err)}var self=this,fn=fn||function(){};return debug('start'),this.on('end',function(){debug('end'),process.removeListener('uncaughtException',uncaught),fn(self.failures)}),this.emit('start'),this.runSuite(this.suite,function(){debug('finished running'),self.emit('end')}),process.on('uncaughtException',uncaught),this},Runner.prototype.abort=function(){debug('aborting'),this._abort=!0}}),require.register('suite.js',function(module,exports,require){function Suite(title,parentContext){this.title=title;var context=function(){};context.prototype=parentContext,this.ctx=new context,this.suites=[],this.tests=[],this.pending=!1,this._beforeEach=[],this._beforeAll=[],this._afterEach=[],this._afterAll=[],this.root=!title,this._timeout=2e3,this._enableTimeouts=!0,this._slow=75,this._bail=!1}function F(){}var EventEmitter=require('browser/events').EventEmitter,debug=require('browser/debug')('mocha:suite'),milliseconds=require('./ms'),utils=require('./utils'),Hook=require('./hook');exports=module.exports=Suite,exports.create=function(parent,title){var suite=new Suite(title,parent.ctx);return suite.parent=parent,parent.pending&&(suite.pending=!0),title=suite.fullTitle(),parent.addSuite(suite),suite};;F.prototype=EventEmitter.prototype,Suite.prototype=new F,Suite.prototype.constructor=Suite,Suite.prototype.clone=function(){var suite=new Suite(this.title);return debug('clone'),suite.ctx=this.ctx,suite.timeout(this.timeout()),suite.enableTimeouts(this.enableTimeouts()),suite.slow(this.slow()),suite.bail(this.bail()),suite},Suite.prototype.timeout=function(ms){return 0==arguments.length?this._timeout:(0===ms&&(this._enableTimeouts=!1),'string'==typeof ms&&(ms=milliseconds(ms)),debug('timeout %d',ms),this._timeout=parseInt(ms,10),this)},Suite.prototype.enableTimeouts=function(enabled){return 0===arguments.length?this._enableTimeouts:(debug('enableTimeouts %s',enabled),this._enableTimeouts=enabled,this)},Suite.prototype.slow=function(ms){return 0===arguments.length?this._slow:('string'==typeof ms&&(ms=milliseconds(ms)),debug('slow %d',ms),this._slow=ms,this)},Suite.prototype.bail=function(bail){return 0==arguments.length?this._bail:(debug('bail %s',bail),this._bail=bail,this)},Suite.prototype.beforeAll=function(title,fn){if(this.pending)return this;'function'==typeof title&&(fn=title,title=fn.name),title='"before all" hook'+(title?': '+title:'');var hook=new Hook(title,fn);return hook.parent=this,hook.timeout(this.timeout()),hook.enableTimeouts(this.enableTimeouts()),hook.slow(this.slow()),hook.ctx=this.ctx,this._beforeAll.push(hook),this.emit('beforeAll',hook),this},Suite.prototype.afterAll=function(title,fn){if(this.pending)return this;'function'==typeof title&&(fn=title,title=fn.name),title='"after all" hook'+(title?': '+title:'');var hook=new Hook(title,fn);return hook.parent=this,hook.timeout(this.timeout()),hook.enableTimeouts(this.enableTimeouts()),hook.slow(this.slow()),hook.ctx=this.ctx,this._afterAll.push(hook),this.emit('afterAll',hook),this},Suite.prototype.beforeEach=function(title,fn){if(this.pending)return this;'function'==typeof title&&(fn=title,title=fn.name),title='"before each" hook'+(title?': '+title:'');var hook=new Hook(title,fn);return hook.parent=this,hook.timeout(this.timeout()),hook.enableTimeouts(this.enableTimeouts()),hook.slow(this.slow()),hook.ctx=this.ctx,this._beforeEach.push(hook),this.emit('beforeEach',hook),this},Suite.prototype.afterEach=function(title,fn){if(this.pending)return this;'function'==typeof title&&(fn=title,title=fn.name),title='"after each" hook'+(title?': '+title:'');var hook=new Hook(title,fn);return hook.parent=this,hook.timeout(this.timeout()),hook.enableTimeouts(this.enableTimeouts()),hook.slow(this.slow()),hook.ctx=this.ctx,this._afterEach.push(hook),this.emit('afterEach',hook),this},Suite.prototype.addSuite=function(suite){return suite.parent=this,suite.timeout(this.timeout()),suite.enableTimeouts(this.enableTimeouts()),suite.slow(this.slow()),suite.bail(this.bail()),this.suites.push(suite),this.emit('suite',suite),this},Suite.prototype.addTest=function(test){return test.parent=this,test.timeout(this.timeout()),test.enableTimeouts(this.enableTimeouts()),test.slow(this.slow()),test.ctx=this.ctx,this.tests.push(test),this.emit('test',test),this},Suite.prototype.fullTitle=function(){if(this.parent){var full=this.parent.fullTitle();if(full)return full+' '+this.title}return this.title},Suite.prototype.total=function(){return utils.reduce(this.suites,function(sum,suite){return sum+suite.total()},0)+this.tests.length},Suite.prototype.eachTest=function(fn){return utils.forEach(this.tests,fn),utils.forEach(this.suites,function(suite){suite.eachTest(fn)}),this}}),require.register('test.js',function(module,exports,require){function Test(title,fn){Runnable.call(this,title,fn),this.pending=!fn,this.type='test'}function F(){}var Runnable=require('./runnable');module.exports=Test;;F.prototype=Runnable.prototype,Test.prototype=new F,Test.prototype.constructor=Test}),require.register('utils.js',function(module,exports,require){function ignored(path){return!~ignore.indexOf(path)}function highlight(js){return js.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\/\/(.*)/gm,'<span class="comment">//$1</span>').replace(/('.*?')/gm,'<span class="string">$1</span>').replace(/(\d+\.\d+)/gm,'<span class="number">$1</span>').replace(/(\d+)/gm,'<span class="number">$1</span>').replace(/\bnew[ \t]+(\w+)/gm,'<span class="keyword">new</span> <span class="init">$1</span>').replace(/\b(function|new|throw|return|var|if|else)\b/gm,'<span class="keyword">$1</span>')}var fs=require('browser/fs'),path=require('browser/path'),basename=path.basename,exists=fs.existsSync||path.existsSync,glob=require('browser/glob'),join=path.join,debug=require('browser/debug')('mocha:watch'),ignore=['node_modules','.git'];exports.escape=function(html){return(html+'').replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;')},exports.forEach=function(arr,fn,scope){for(var i=0,l=arr.length;i<l;i++)fn.call(scope,arr[i],i)},exports.map=function(arr,fn,scope){for(var result=[],i=0,l=arr.length;i<l;i++)result.push(fn.call(scope,arr[i],i));return result},exports.indexOf=function(arr,obj,start){for(var i=start||0,l=arr.length;i<l;i++)if(arr[i]===obj)return i;return-1},exports.reduce=function(arr,fn,val){for(var rval=val,i=0,l=arr.length;i<l;i++)rval=fn(rval,arr[i],i,arr);return rval},exports.filter=function(arr,fn){for(var val,ret=[],i=0,l=arr.length;i<l;i++)val=arr[i],fn(val,i,arr)&&ret.push(val);return ret},exports.keys=Object.keys||function(obj){var keys=[],has=Object.prototype.hasOwnProperty;for(var key in obj)has.call(obj,key)&&keys.push(key);return keys},exports.watch=function(files,fn){var options={interval:100};files.forEach(function(file){debug('file %s',file),fs.watchFile(file,options,function(curr,prev){prev.mtime<curr.mtime&&fn(file)})})},exports.files=function(dir,ext,ret){ret=ret||[],ext=ext||['js'];var re=new RegExp('\\.('+ext.join('|')+')$');return fs.readdirSync(dir).filter(ignored).forEach(function(path){path=join(dir,path),fs.statSync(path).isDirectory()?exports.files(path,ext,ret):path.match(re)&&ret.push(path)}),ret},exports.slug=function(str){return str.toLowerCase().replace(/ +/g,'-').replace(/[^-\w]/g,'')},exports.clean=function(str){str=str.replace(/\r\n?|[\n\u2028\u2029]/g,'\n').replace(/^\uFEFF/,'').replace(/^function *\(.*\) *{|\(.*\) *=> *{?/,'').replace(/\s+\}$/,'');var spaces=str.match(/^\n?( *)/)[1].length,tabs=str.match(/^\n?(\t*)/)[1].length,re=new RegExp('^\n?'+(tabs?'\t':' ')+'{'+(tabs?tabs:spaces)+'}','gm');return str=str.replace(re,''),exports.trim(str)},exports.trim=function(str){return str.replace(/^\s+|\s+$/g,'')},exports.parseQuery=function(qs){return exports.reduce(qs.replace('?','').split('&'),function(obj,pair){var i=pair.indexOf('='),key=pair.slice(0,i),val=pair.slice(++i);return obj[key]=decodeURIComponent(val),obj},{})},exports.highlightTags=function(name){for(var code=document.getElementById('mocha').getElementsByTagName(name),i=0,len=code.length;i<len;++i)code[i].innerHTML=highlight(code[i].innerHTML)},exports.stringify=function(obj){return obj instanceof RegExp?obj.toString():JSON.stringify(exports.canonicalize(obj),null,2).replace(/,(\n|$)/g,'$1')},exports.canonicalize=function(obj,stack){if(stack=stack||[],-1!==exports.indexOf(stack,obj))return'[Circular]';var canonicalizedObj;return'[object Array]'==={}.toString.call(obj)?(stack.push(obj),canonicalizedObj=exports.map(obj,function(item){return exports.canonicalize(item,stack)}),stack.pop()):'object'==typeof obj&&null!==obj?(stack.push(obj),canonicalizedObj={},exports.forEach(exports.keys(obj).sort(),function(key){canonicalizedObj[key]=exports.canonicalize(obj[key],stack)}),stack.pop()):canonicalizedObj=obj,canonicalizedObj},exports.lookupFiles=function lookupFiles(path,extensions,recursive){var files=[],re=new RegExp('\\.('+extensions.join('|')+')$');if(!exists(path))if(exists(path+'.js'))path+='.js';else{if(files=glob.sync(path),!files.length)throw new Error('cannot resolve path (or pattern) \''+path+'\'');return files}try{var stat=fs.statSync(path);if(stat.isFile())return path}catch(ignored){return}return fs.readdirSync(path).forEach(function(file){file=join(path,file);try{var stat=fs.statSync(file);if(stat.isDirectory())return void(recursive&&(files=files.concat(lookupFiles(file,extensions,recursive))))}catch(ignored){return}stat.isFile()&&re.test(file)&&'.'!==basename(file)[0]&&files.push(file)}),files}});var global=function(){return this}(),Date=global.Date,setTimeout=global.setTimeout,setInterval=global.setInterval,clearTimeout=global.clearTimeout,clearInterval=global.clearInterval,process={};process.exit=function(status){},process.stdout={};var uncaughtExceptionHandlers=[],originalOnerrorHandler=global.onerror;process.removeListener=function(e,fn){if('uncaughtException'==e){global.onerror=originalOnerrorHandler?originalOnerrorHandler:function(){};var i=Mocha.utils.indexOf(uncaughtExceptionHandlers,fn);-1!=i&&uncaughtExceptionHandlers.splice(i,1)}},process.on=function(e,fn){'uncaughtException'==e&&(global.onerror=function(err,url,line){return fn(new Error(err+' ('+url+':'+line+')')),!0},uncaughtExceptionHandlers.push(fn))};var Mocha=global.Mocha=require('mocha'),mocha=global.mocha=new Mocha({reporter:'html'});mocha.suite.removeAllListeners('pre-require');var immediateTimeout,immediateQueue=[];Mocha.Runner.immediately=function(callback){immediateQueue.push(callback),immediateTimeout||(immediateTimeout=setTimeout(timeslice,0))},mocha.throwError=function(err){throw Mocha.utils.forEach(uncaughtExceptionHandlers,function(fn){fn(err)}),err},mocha.ui=function(ui){return Mocha.prototype.ui.call(this,ui),this.suite.emit('pre-require',global,null,this),this},mocha.setup=function(opts){for(var opt in'string'==typeof opts&&(opts={ui:opts}),opts)this[opt](opts[opt]);return this},mocha.run=function(fn){var options=mocha.options;mocha.globals('location');var query=Mocha.utils.parseQuery(global.location.search||'');return query.grep&&mocha.grep(query.grep),query.invert&&mocha.invert(),Mocha.prototype.run.call(mocha,function(err){var document=global.document;document&&document.getElementById('mocha')&&!0!==options.noHighlighting&&Mocha.utils.highlightTags('code'),fn&&fn(err)})},Mocha.process=process,require.register('reporters/ti-json.js',function(module,exports,require){function TiJSONReporter(runner){var self=this;Base.call(this,runner);var tests=[],failures=[],passes=[];runner.on('test end',function(test){tests.push(test)}),runner.on('pass',function(test){passes.push(test)}),runner.on('fail',function(test){failures.push(test)}),runner.on('end',function(){var obj={stats:self.stats,tests:tests.map(clean),failures:failures.map(clean),passes:passes.map(clean)};console.log(cursor.resetLine+JSON.stringify(obj,null,2)),runner.results=obj})}function clean(test){return{title:test.title,fullTitle:test.fullTitle(),duration:test.duration}}var Base=require('./base'),cursor=require('titanium/util').cursor,color=Base.color;exports=module.exports=TiJSONReporter}),require.register('reporters/ti-spec-studio.js',function(module,exports,require){function TiSpecStudio(runner){function NL(){Ti.API.info(cursor.reset+' '+cursor.reset)}function indent(){return cursor.reset+Array(indents).join('  ')+cursor.reset}Base.call(this,runner);var self=this,stats=this.stats,indents=0,n=0;runner.on('start',function(){NL()}),runner.on('suite',function(suite){++indents,Ti.API.info(indent()+suite.title)}),runner.on('suite end',function(suite){--indents,1==indents&&NL()}),runner.on('pending',function(test){Ti.API.warn(indent()+'  - '+test.title+' (pending)')}),runner.on('pass',function(test){'fast'===test.speed?Ti.API.info(indent()+'  + '+test.title):Ti.API.info(indent()+'  + '+test.title+' ('+test.duration+'ms)')}),runner.on('fail',function(test,err){Ti.API.error(indent()+'  '+ ++n+') '+test.title)}),runner.on('end',function(){self.epilogue()})}function F(){}var Base=require('./base'),cursor=require('titanium/util').cursor;exports=module.exports=TiSpecStudio,F.prototype=Base.prototype,TiSpecStudio.prototype=new F,TiSpecStudio.prototype.constructor=TiSpecStudio}),require.register('reporters/ti-spec.js',function(module,exports,require){function TiSpec(runner){function NL(){log(cursor.reset+' '+cursor.reset)}function upOne(){return cursor.previousLine+cursor.resetLine}function indent(){return Array(indents).join('  ')}function log(msg){console.log(cursor.resetLine+msg)}Base.call(this,runner);var self=this,stats=this.stats,indents=0,n=0;runner.on('start',function(){NL()}),runner.on('suite',function(suite){++indents,log(color('suite',indent()+suite.title))}),runner.on('suite end',function(suite){--indents,1==indents&&NL()}),runner.on('test',function(test){log(color('pass',indent()+'  o '+test.title+': '))}),runner.on('pending',function(test){log(color('pending',indent()+'  - '+test.title))}),runner.on('pass',function(test){'fast'===test.speed?log(upOne()+color('checkmark',indent()+'  +')+color('pass',' '+test.title+' ')):log(upOne()+color('checkmark',indent()+'  +')+color('pass',' '+test.title+' ')+color(test.speed,'('+test.duration+'ms)'))}),runner.on('fail',function(test,err){log(color('fail',upOne()+indent()+'  '+ ++n+') '+test.title))}),runner.on('end',function(){self.epilogue()})}function F(){}var Base=require('./base'),cursor=require('titanium/util').cursor,color=Base.color;exports=module.exports=TiSpec,F.prototype=Base.prototype,TiSpec.prototype=new F,TiSpec.prototype.constructor=TiSpec}),require.register('titanium/util.js',function(module,exports,require){function objectToString(o){return Object.prototype.toString.call(o)}function isArray(ar){return Array.isArray(ar)}function isString(o){return'string'==typeof o}function isBoolean(o){return'boolean'==typeof o}function isUndefined(arg){return void 0===arg}function isNull(arg){return null===arg}function isObject(arg){return'object'==typeof arg&&null!==arg}function isFunction(arg){return'function'==typeof arg}function isNumber(arg){return'number'==typeof arg}function isRegExp(re){return isObject(re)&&'[object RegExp]'===objectToString(re)}function isDate(d){return isObject(d)&&'[object Date]'===objectToString(d)}function isError(e){return isObject(e)&&('[object Error]'===objectToString(e)||e instanceof Error)}function formatError(value){return'['+Error.prototype.toString.call(value)+']'}function arrayToHash(array){var hash={};return array.forEach(function(val,idx){hash[val]=!0}),hash}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;i<l;++i)hasOwnProperty(value,i+'')?output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,i+'',!0)):output.push('');return keys.forEach(function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))}),output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if(desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]},desc.get?desc.set?str=ctx.stylize('[Getter/Setter]','special'):str=ctx.stylize('[Getter]','special'):desc.set&&(str=ctx.stylize('[Setter]','special')),hasOwnProperty(visibleKeys,key)||(name='['+key+']'),str||(0>ctx.seen.indexOf(desc.value)?(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1),-1<str.indexOf('\n')&&(array?str=str.split('\n').map(function(line){return'  '+line}).join('\n').substr(2):str='\n'+str.split('\n').map(function(line){return'   '+line}).join('\n'))):str=ctx.stylize('[Circular]','special')),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;name=JSON.stringify(''+key),name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,'name')):(name=name.replace(/'/g,'\\\'').replace(/\\"/g,'"').replace(/(^"|"$)/g,'\''),name=ctx.stylize(name,'string'))}return name+': '+str}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?'\x1B['+inspect.colors[style][0]+'m'+str+'\x1B['+inspect.colors[style][1]+'m':str}function inspect(obj,opts){var ctx={seen:[],stylize:function(s){return s}};return 3<=arguments.length&&(ctx.depth=arguments[2]),4<=arguments.length&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&!(value.constructor&&value.constructor.prototype===value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=formatPrimitive(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=arrayToHash(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),0===keys.length){if(isFunction(value)){var name=value.name?': '+value.name:'';return ctx.stylize('[Function'+name+']','special')}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),'regexp');if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),'date');if(isError(value))return formatError(value)}var base='',array=!1,braces=['{','}'];if(isArray(value)&&(array=!0,braces=['[',']']),isFunction(value)){var n=value.name?': '+value.name:'';base=' [Function'+n+']'}if(isRegExp(value)&&(base=' '+RegExp.prototype.toString.call(value)),isDate(value)&&(base=' '+Date.prototype.toUTCString.call(value)),isError(value)&&(base=' '+formatError(value)),0===keys.length&&(!array||0===value.length))return braces[0]+base+braces[1];if(0>recurseTimes)return isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),'regexp'):ctx.stylize('[Object]','special');ctx.seen.push(value);var output;return output=array?formatArray(ctx,value,recurseTimes,visibleKeys,keys):keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}),ctx.seen.pop(),reduceToSingleString(output,base,braces)}function reduceToSingleString(output,base,braces){var numLinesEst=0,length=output.reduce(function(prev,cur){return numLinesEst++,0<=cur.indexOf('\n')&&numLinesEst++,prev+cur.replace(/\u001b\[\d\d?m/g,'').length+1},0);return 60<length?braces[0]+(''===base?'':base+'\n ')+' '+output.join(',\n  ')+' '+braces[1]:braces[0]+base+' '+output.join(', ')+' '+braces[1]}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize('undefined','undefined');if(isString(value)){var simple='\''+JSON.stringify(value).replace(/^"|"$/g,'').replace(/'/g,'\\\'').replace(/\\"/g,'"')+'\'';return ctx.stylize(simple,'string')}return isNumber(value)?0===value&&0>1/value?ctx.stylize('-0','number'):ctx.stylize(''+value,'number'):isBoolean(value)?ctx.stylize(''+value,'boolean'):isNull(value)?ctx.stylize('null','null'):void 0}exports.cursor={previousLine:'\x1B[1F',beginningOfLine:'\x1B[0G',eraseLine:'\x1B[2K',reset:'\x1B[0m'},exports.cursor.resetLine=exports.cursor.beginningOfLine+exports.cursor.eraseLine;var formatRegExp=/%[sdj%]/g;exports.format=function(f){var i;if(!isString(f)){var objects=[];for(i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(' ')}i=1;for(var args=arguments,len=args.length,str=(f+'').replace(formatRegExp,function(x){if('%%'===x)return'%';if(i>=len)return x;switch(x){case'%s':return args[i++]+'';case'%d':return+args[i++];case'%j':try{return JSON.stringify(args[i++])}catch(_){return'[Circular]'}default:return x;}}),x=args[i];i<len;x=args[++i])str+=isNull(x)||!isObject(x)?' '+x:' '+inspect(x);return str}}),global.location={};var _mochaRun=mocha.run;mocha.run=function(fn){return _mochaRun.call(this,function(){mocha.suite.suites.length=0,fn&&fn.apply(this,arguments)})},mocha.reporter=function(r){return Mocha.prototype.reporter.call(this,r),this._ti_reporter=r,this},mocha.outputFile=function(outputFile){this._ti_output_file=outputFile},mocha.quiet=function(val){this._ti_quiet=val};

for(var console={},types=['info','log','error','warn','trace'],i=0;i<types.length;i++)
createConsoleLogger(types[i]);


mocha.setup({
ui:'bdd',
reporter:'ti-spec'});

})();